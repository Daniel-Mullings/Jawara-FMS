<%- include('partials/header') %>

<body class="home_body g-sidenav-show bg-gray-100">
  <div class="min-height-300 position-absolute w-100 body_wallpaper"></div>
  <aside
    class="sidenav bg-white navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-4"
    id="sidenav-main"
  >
    <div class="sidenav-header">
      <i
        class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none"
        aria-hidden="true"
        id="iconSidenav"
      ></i>
      <a class="navbar-brand m-0" href="homepage" target="_blank">
        <!--<img
          src="img/logo.png"
          class="navbar-brand-img h-100"
          alt="main_logo"
        />-->
        <span class="ms-1 font-weight-bold logo_design">JAWARA</span>
      </a>
    </div>
    <hr class="horizontal dark mt-0" />
    <div class="w-auto">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link active" href="homepage">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i class="ni ni-tv-2 text-primary text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="timetable">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i
                class="ni ni-calendar-grid-58 text-warning text-sm opacity-10"
              ></i>
            </div>
            <span class="nav-link-text ms-1">Machine Timetables</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="kanban">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i class="ni ni-building text-success text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Work Area</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="stocks">
            <div
              class="icon icon-shape text icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i class="ni ni-app text-info text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Inventory Stock</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="viewstocks">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i class="ni ni-world-2 text-danger text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">View Inventory</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="orders">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i
                class="ni ni-bag-17 text-info text-sm opacity-10 order-bag"
              ></i>
            </div>
            <span class="nav-link-text ms-1">Orders</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="billing">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i class="ni ni-credit-card text-sm opacity-10" style="color: sandybrown !important;"></i>
            </div>
            <span class="nav-link-text ms-1">Billing</span>
          </a>
        </li>
        <li class="nav-item mt-3">
          <h6
            class="ps-4 ms-2 text-uppercase text-xs font-weight-bolder opacity-6"
          >
            Account pages
          </h6>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="pages/profile.html">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i class="ni ni-single-02 text-dark text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Profile</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="pages/sign-in.html">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i
                class="ni ni-single-copy-04 text-warning text-sm opacity-10"
              ></i>
            </div>
            <span class="nav-link-text ms-1">Sign In</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="pages/sign-up.html">
            <div
              class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center"
            >
              <i class="ni ni-collection text-info text-sm opacity-10"></i>
            </div>
            <span class="nav-link-text ms-1">Sign Up</span>
          </a>
        </li>
      </ul>
    </div>
  </aside>
  <main class="main-content position-relative border-radius-lg">
    <!-- Navbar -->
    <nav
      class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl"
      id="navbarBlur"
      data-scroll="false"
    >
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
          <ol
            class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5"
          >
            <li class="breadcrumb-item text-sm">
              <a class="opacity-5 text-white" href="javascript:;">Pages</a>
            </li>
            <li
              class="breadcrumb-item text-sm text-white active"
              aria-current="page"
            >
              Billing
            </li>
          </ol>
          <h6
            class="font-weight-bolder text-white mb-0"
            style="font-size: 1.5rem"
          >
            Billing
          </h6>
        </nav>
        <div
          class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4"
          id="navbar"
        >
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <div class="input-group">
              <span class="input-group-text text-body"
                ><i class="fas fa-search" aria-hidden="true"></i
              ></span>
              <input
                type="text"
                class="form-control"
                placeholder="Type here..."
              />
            </div>
          </div>
          <ul class="navbar-nav justify-content-end">
            <li class="nav-item d-flex align-items-center">
              <a href="login" class="nav-link text-white font-weight-bold px-0">
                <i class="fa fa-user me-sm-1"></i>
                <span class="d-sm-inline d-none">Sign In</span>
              </a>
            </li>
            <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
              <a
                href="javascript:;"
                class="nav-link text-white p-0"
                id="iconNavbarSidenav"
              >
                <div class="sidenav-toggler-inner">
                  <i class="sidenav-toggler-line bg-white"></i>
                  <i class="sidenav-toggler-line bg-white"></i>
                  <i class="sidenav-toggler-line bg-white"></i>
                </div>
              </a>
            </li>
            <li class="nav-item px-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-white p-0">
                <i class="fa fa-cog fixed-plugin-button-nav cursor-pointer"></i>
              </a>
            </li>
            <li class="nav-item dropdown pe-2 d-flex align-items-center">
              <a
                href="javascript:;"
                class="nav-link text-white p-0"
                id="dropdownMenuButton"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                <i class="fa fa-bell cursor-pointer"></i>
              </a>
              <ul
                class="dropdown-menu dropdown-menu-end px-2 py-3 me-sm-n4"
                aria-labelledby="dropdownMenuButton"
              >
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img
                          src="img/team-2.jpg"
                          class="avatar avatar-sm me-3"
                        />
                      </div>
                      <div
                        class="d-flex flex-column justify-content-center new_message_font"
                      >
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold">New message</span> from
                          Michael Moore
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          13 minutes ago
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li class="mb-2">
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div class="my-auto">
                        <img
                          src="img/newtask1.png"
                          class="avatar avatar-sm bg-gradient-dark me-3"
                        />
                      </div>
                      <div
                        class="d-flex flex-column justify-content-center new_message_font"
                      >
                        <h6 class="text-sm font-weight-normal mb-1">
                          <span class="font-weight-bold">New Task</span> sent by
                          Paul Stevens
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          1 day
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
                <li>
                  <a class="dropdown-item border-radius-md" href="javascript:;">
                    <div class="d-flex py-1">
                      <div
                        class="avatar avatar-sm bg-gradient-secondary me-3 my-auto"
                      >
                        <svg
                          width="12px"
                          height="12px"
                          viewBox="0 0 43 36"
                          version="1.1"
                          xmlns="http://www.w3.org/2000/svg"
                          xmlns:xlink="http://www.w3.org/1999/xlink"
                        >
                          <title>credit-card</title>
                          <g
                            stroke="none"
                            stroke-width="1"
                            fill="none"
                            fill-rule="evenodd"
                          >
                            <g
                              transform="translate(-2169.000000, -745.000000)"
                              fill="#FFFFFF"
                              fill-rule="nonzero"
                            >
                              <g transform="translate(1716.000000, 291.000000)">
                                <g
                                  transform="translate(453.000000, 454.000000)"
                                >
                                  <path
                                    class="color-background"
                                    d="M43,10.7482083 L43,3.58333333 C43,1.60354167 41.3964583,0 39.4166667,0 L3.58333333,0 C1.60354167,0 0,1.60354167 0,3.58333333 L0,10.7482083 L43,10.7482083 Z"
                                    opacity="0.593633743"
                                  ></path>
                                  <path
                                    class="color-background"
                                    d="M0,16.125 L0,32.25 C0,34.2297917 1.60354167,35.8333333 3.58333333,35.8333333 L39.4166667,35.8333333 C41.3964583,35.8333333 43,34.2297917 43,32.25 L43,16.125 L0,16.125 Z M19.7083333,26.875 L7.16666667,26.875 L7.16666667,23.2916667 L19.7083333,23.2916667 L19.7083333,26.875 Z M35.8333333,26.875 L28.6666667,26.875 L28.6666667,23.2916667 L35.8333333,23.2916667 L35.8333333,26.875 Z"
                                  ></path>
                                </g>
                              </g>
                            </g>
                          </g>
                        </svg>
                      </div>
                      <div
                        class="d-flex flex-column justify-content-center new_message_font"
                      >
                        <h6 class="text-sm font-weight-normal mb-1">
                          Payment successfully completed
                        </h6>
                        <p class="text-xs text-secondary mb-0">
                          <i class="fa fa-clock me-1"></i>
                          2 days
                        </p>
                      </div>
                    </div>
                  </a>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->

    <!-- Billing -->
    <div class="container-fluid">
        <h1 class="orders" style="display: flex !important; margin-bottom: 0 !important">Billing</h1>
        <img class="ui small rounded image" style="
        display: flex !important;
        width: 250px !important;
        margin: auto !important;
        justify-content: center !important;
      "
      src="img/credit.svg">
        <br>
        <span class="btn btn_row_add_below_end search-button" style="width: 13% !important">Add New Item <i class="shopping cart icon"></i></span>
        <br>
        <div class="ui fluid container">
        <form action="/submitbill" method="POST">
        <table class="ui inverted pink celled table celled tbl_code_with_mark" id="myTable">
        <thead>
            <tr class="table-head">
            <th>Part No.</th>
            <th>Part ID</th>
            <th>Part Name</th>
            <th>Category</th>
            <th>Producer</th>
            <th>Supplier</th>
            <th>Amount</th>
            <th>Phone Number</th>
            </tr>
        </thead>
        
        <tbody>
            
            <tr style="background-color: #f3f2f8 !important">
            <td><input type="text" id="number1" value=1 name="number1" style="border:0;outline:0" size="4" disabled/></td>
            <td>
                <div class="form-floating">
                <input type="text" class="form-control" id="partid1" name="partid1"  size="4" required>
                <label for="floatingInput">ID</label>
                <button type="button" class="btn btn-sm search-button" style="width:50%; justify-content: center !important; text-align: center !important; margin-top: 0.3rem !important;" id="fetchpart1" onclick="fetchitem()">Get Item</button>
                </div>
            </td>
            <td>
                <div class="form-floating">
                <input type="text" class="form-control" id="partname1" name="partname1" size="4" required >
                <label for="floatingInput">Name</label>
                
            </div>
            </td>
            <td> 
                <div class="form-floating">
                    <select class="form-select" aria-label="Default select example" name="category1" id="category1" required > 
                    <% category.forEach(function(order){ %>
                        <option name="<%= order.Category %>" value="<%= order.Category %>"><%= order.Category %></option>
                    <% }); %>
                
                    </select>
                    <label for="floatingInput">Category</label>
                </div>
                </td>
                <td>
                <div class="form-floating">
                    <select class="form-select" aria-label="Default select example" name="producers1" id="producers1" required >
                    <% producers.forEach(function(order){ %>
                    <option value="<%= order.Producers %>"><%= order.Producers %></option>
                    <% }); %>
                
                    </select>
                    <label for="floatingInput">Producer</label>
                </div>
                </td>
                <td>
                <div class="form-floating">
                    <select class="form-select" aria-label="Default select example" name="suppliers1" id="suppliers1" required >
                    <% suppliers.forEach(function(order){ %>
                        <option value="<%= order.Suppliers %>"><%= order.Suppliers %></option>
                    <% }); %>
                
                    </select>
                    <label for="floatingInput">Supplier</label>
                </div>
                </td>
                <td> 
                <div class="form-floating">
                    <input type="number" class="form-control" id="amount1" name="amount1" value=0 min="0" max="99999" required>
                    <label for="floatingInput">Amount <i class="dollar sign icon"></i></label>
                    
                </div>
                </td>
                <td>
                <div class="form-floating">
                    <input type="text" class="form-control" id="customer1" name="customer1" size="4" required >
                    <label for="floatingInput">Phone<i class="phone volume icon"></i></label>
                </div>
                </td>
            </tr>
        
            </tbody>
            
        
            </table>
            <div style="display: flex; justify-content: center; margin: auto; align-items: center; margin-top: 2rem;">
                <button type="submit" class="ui teal submit button">Submit</button>
                    
                </form>
                
                <button class="ui green submit button" type="button" onclick="downloadInvoice()">Download Bill</button>
            </div>
            <h4 class="ui horizontal divider header">
                <i class="dollar sign icon"></i>
            TOTAL CART VALUE
            </h4>
            <br>
            
                <div class="card text-dark" style="width: 12rem; background: rgb(144, 154, 182) !important; justify-content: center !important; margin: auto !important;">
                    
                    <div class="card-body">
                    <div class="form-floating">
                        <input type="number" class="form-control"  style="background-color: #fff !important;" id="total" name="total" value=0  required disabled>
                        <label for="floatingInput">Total Amount</label>
                    
                    </div>
                    </div>
                </div>     
        </div>
    </div>

      <!-- Footer-->
      <footer class="footer pt-3 fixed-bottom">
        <div class="container-fluid">
          <div class="row align-items-center justify-content-lg-between">
            <div class="col-lg-6 mb-lg-0 mb-4">
              <div
                class="copyright text-center text-sm text-muted text-lg-start"
              >
                ©
                <script>
                  document.write(new Date().getFullYear())
                </script>
                , Jawara Group of Companies
              </div>
            </div>
            <div class="col-lg-6">
              <ul
                class="nav nav-footer justify-content-center justify-content-lg-end"
              >
                <li class="nav-item">
                  <a href="#" class="nav-link text-muted" target="_blank"
                    >Privacy policy</a
                  >
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link text-muted" target="_blank"
                    >About Us</a
                  >
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link text-muted" target="_blank"
                    >Blog</a
                  >
                </li>
                <li class="nav-item">
                  <a href="#" class="nav-link pe-0 text-muted" target="_blank"
                    >License</a
                  >
                </li>
              </ul>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </main>
  <div class="fixed-plugin">
    <a class="fixed-plugin-button text-dark position-fixed px-3 py-2">
      <i class="fa fa-cog py-2"> </i>
    </a>
    <div class="card shadow-lg">
      <div class="card-header pb-0 pt-3">
        <div class="float-start">
          <h5 class="mt-3 mb-0">Settings</h5>
          <p>Customize dashboard</p>
        </div>
        <div class="float-end mt-4">
          <button class="btn btn-link text-dark p-0 fixed-plugin-close-button">
            <i class="fa fa-close"></i>
          </button>
        </div>
        <!-- End Toggle Button -->
      </div>
      <hr class="horizontal dark my-1" />
      <div class="card-body pt-sm-3 pt-0 overflow-auto">
        <!-- Sidebar Backgrounds -->
        <div>
          <h6 class="mb-0">Sidebar Colors</h6>
        </div>
        <a href="javascript:void(0)" class="switch-trigger background-color">
          <div class="badge-colors my-2 text-start">
            <span
              class="badge filter bg-gradient-primary active"
              data-color="primary"
              onclick="sidebarColor(this)"
            ></span>
            <span
              class="badge filter bg-gradient-dark"
              data-color="dark"
              onclick="sidebarColor(this)"
            ></span>
            <span
              class="badge filter bg-gradient-info"
              data-color="info"
              onclick="sidebarColor(this)"
            ></span>
            <span
              class="badge filter bg-gradient-success"
              data-color="success"
              onclick="sidebarColor(this)"
            ></span>
            <span
              class="badge filter bg-gradient-warning"
              data-color="warning"
              onclick="sidebarColor(this)"
            ></span>
            <span
              class="badge filter bg-gradient-danger"
              data-color="danger"
              onclick="sidebarColor(this)"
            ></span>
          </div>
        </a>
        <!-- Sidenav Type -->
        <div class="mt-3">
          <h6 class="mb-0">Sidenav Type</h6>
          <p class="text-sm">Choose between 2 different sidenav types.</p>
        </div>
        <div class="d-flex">
          <button
            class="btn bg-gradient-primary w-100 px-3 mb-2 active me-2"
            data-class="bg-white"
            onclick="sidebarType(this)"
          >
            White
          </button>
          <button
            class="btn bg-gradient-primary w-100 px-3 mb-2"
            data-class="bg-default"
            onclick="sidebarType(this)"
          >
            Dark
          </button>
        </div>
        <p class="text-sm d-xl-none d-block mt-2">
          You can change the sidenav type just on desktop view.
        </p>
        <!-- Navbar Fixed -->
        <div class="d-flex my-3">
          <h6 class="mb-0">Navbar Fixed</h6>
          <div class="form-check form-switch ps-0 ms-auto my-auto">
            <input
              class="form-check-input mt-1 ms-auto"
              type="checkbox"
              id="navbarFixed"
              onclick="navbarFixed(this)"
            />
          </div>
        </div>
        <hr class="horizontal dark my-sm-4" />
        <div class="mt-2 mb-5 d-flex">
          <h6 class="mb-0">Light / Dark</h6>
          <div class="form-check form-switch ps-0 ms-auto my-auto">
            <input
              class="form-check-input mt-1 ms-auto"
              type="checkbox"
              id="dark-version"
              onclick="darkMode(this)"
            />
          </div>
        </div>
      </div>
    </div>
  </div>
  <!--   Core JS Files   -->
  <script src="js/core/popper.min.js"></script>
  <script scrc="js/core/bootstrap.min.js"></script>

  <script>
    $(document).ready(function($)
    {
      $(document).on('click',".btn_row_add_below_end", function(e)
      {
        var tableBody = $(document).find('.tbl_code_with_mark').find("tbody");
        var trLast = tableBody.find("tr:last");
        var trNew = trLast.clone();
        var x = document.getElementById('myTable');
        var len = x.rows.length;
        trLast.after(trNew);
       
      
        var inputs = document.getElementsByTagName("input");
        var flag1=flag2=1;
        for (var i = 0; i < inputs.length; i++) {
          if(inputs[i].id != 'total'){
        
          inputs[i].id = (inputs[i].id).replace(/\d+/g, '')
          inputs[i].name = (inputs[i].name).replace(/\d+/g, '')
          inputs[i].id = inputs[i].id + (flag1).toString();
          inputs[i].name = inputs[i].name + (flag1).toString();
          if(flag2%5==0)
          {
            flag1++;
          }
          flag2++;
          
        }
        }
        var count = 0
        for (var i = 0; i < inputs.length; i++) {
          if((inputs[i].id).includes("number")){
            // console.log(`Item Name = ${inputs[i]}`)
            // console.log(`Before value = ${inputs[i].value}`)
            inputs[i].value = count + 1
            // console.log(`After value = ${inputs[i].value}`)
            count++;
          }
        }
        for (var i = 0; i < inputs.length; i++) {
          if(inputs[i].id != 'total'){
          if((inputs[i].id).includes(len.toString()) && !((inputs[i].id).includes("number")) ){
            inputs[i].value = ""
            inputs[i].innerText = ""
          }
        }
        }
        console.log(inputs)
        selects = document.getElementsByTagName("select");
        var flag1=flag2=1;
        for (var i = 0; i < selects.length; i++) {
          selects[i].id = (selects[i].id).replace(/\d+/g, '')
          selects[i].name= (selects[i].name).replace(/\d+/g, '')
          selects[i].id = selects[i].id + (flag1).toString()
          selects[i].name = selects[i].name + (flag1).toString();
          if(flag2%3==0)
          {
            flag1++;
          }
          flag2++;
        }
        console.log(selects)
        buttons = document.getElementsByTagName("button");
        var flag1=1;
        for(var i = 0; i < buttons.length; i++) {
          if((buttons[i].id).includes("fetchpart")){
          buttons[i].id = (buttons[i].id).replace(/\d+/g, '')
          buttons[i].name= (buttons[i].name).replace(/\d+/g, '')
          buttons[i].id = buttons[i].id + (flag1).toString()
          buttons[i].name = buttons[i].name + (flag1).toString();
            flag1++;
        
        }
      }
      });
    });
  </script>
  <script>
    function fetchitem() {
    console.log('fetch button called')
    var buttons = document.getElementsByTagName("button");
    button_num = ""
    for(var i = 0; i < buttons.length; i++) {
      if((buttons[i].id).includes("fetchpart")){
          button_id = buttons[i].id
          console.log(buttons[i])
          console.log(buttons[i].id)
          button_num = (button_id.match(/(\d+)/))[0]
          console.log(button_num)
      }
    }
    console.log(buttons)
    var inputs = document.getElementsByTagName("input");
    var pass_part = ""
    for (var i = 0; i < inputs.length; i++) {
          input_id = inputs[i].id
          if((inputs[i].id).includes("partid") && ((input_id.charAt(input_id.length-1)) == button_num)){
            pass_part = inputs[i]
            console.log(pass_part)
          }
        }
        console.log(inputs)
  $.ajax({
      type: "POST",
      url: "/fetchpart",
      data: {
          "partid": pass_part.value
      },
      success: function(data) {
        // console.log('Fetched Data')
          if(data.status == 200) {
              
              x = data.rows
              var inputs = document.getElementsByTagName("input");
              partname_id = "partname" + button_num
              amount_id = "amount" + button_num
              category_id = "category" + button_num
              producers_id = "producers" + button_num
              suppliers_id = "suppliers" + button_num
             
              for (var i = 0; i < inputs.length; i++) {
                if(inputs[i].id == partname_id){
                  
                inputs[i].value = x[0].PartName
                // console.log(x['PartName'])
                }
                if(inputs[i].id == amount_id){
                inputs[i].value = x[0].Amount
                // console.log(x.Amount)
                }
              }
              var total_amount = 0
              for (var i = 0; i < inputs.length; i++) {
               
                if((inputs[i].id).includes("amount")){
                  total_amount = total_amount + parseInt(inputs[i].value)
                // console.log(x.Amount)
                }
              }
              // console.log(total_amount)
              for (var i = 0; i < inputs.length; i++) {
                if(inputs[i].id == 'total')
                inputs[i].value = total_amount
              }
              
              // console.log(inputs)
              // alert("successfully fetched!")
            var selects = document.getElementsByTagName("select");
            for (var i = 0; i < selects.length; i++) {
                if(selects[i].id == category_id){
                  
                selects[i].value = x[0].Category
                
                }
                if(selects[i].id == producers_id){
                selects[i].value = x[0].Producers
               
                }
                if(selects[i].id == suppliers_id){
                selects[i].value = x[0].Suppliers
                
                }
              }
          } else if(data.status == "failed") {
              alert("failed authentication!")
          }
      }
  });
}
</script>


<script>
function downloadInvoice() {
    function getSampleData() {
var date_format = new Date();
var transaction_time = date_format.getHours() + ':' + date_format.getMinutes() + ':' + date_format.getSeconds();
var transaction_date = date_format.getDate() + '/' + (parseInt(date_format.getMonth() + 1)).toString() + '/' + date_format.getFullYear();
var transaction_id = "SHW" + date_format.getDate() + date_format.getMonth() + date_format.getFullYear().toString().substr(-2) + date_format.getHours() + date_format.getMinutes() + date_format.getSeconds();
var part_names = document.getElementsByTagName('input')
var part_arr = []
for(var i=0; i<part_names.length; i++){
  if((part_names[i].id).includes('partname')){
    var part_num = (part_names[i].id).charAt((part_names[i].id).length-1)
    for(var j=0;j<part_names.length;j++){
      if((part_names[j].id).includes('amount')){
      var amount_num = (part_names[j].id).charAt((part_names[j].id).length-1)
      if(part_num == amount_num){
        let part_obj = {
          "quantity": "1",
          "description": part_names[i].value,
          "tax": 0,
          "price": part_names[j].value
        }
        console.log(part_obj)
        part_arr.push(part_obj)
      }
    }
    }
  }
}
console.log(part_arr)
return {
  //"documentTitle": "RECEIPT", //Defaults to INVOICE
  "currency": "INR",
  "taxNotation": "gst", //or gst
  "marginTop": 25,
  "marginRight": 25,
  "marginLeft": 25,
  "marginBottom": 25,
  "logo": "https://i.pinimg.com/564x/47/7c/4c/477c4c269034cc0bc048409346ac83e9.jpg", //or base64
  //"logoExtension": "png", //only when logo is base64
  "sender": {
    "company": "<shop-name>",
    "address": "<shop-address>",
    "zip": "<shop-zip>",
    "city": "<shop-city>",
    "country": "Mob. - <shop-owner-mobile-number>",
     
    "custom1": "GST No. - <shop-gst-no.>"
    //"custom2": "custom value 2",
    //"custom3": "custom value 3"
  },
  "invoiceNumber": transaction_id,
  "invoiceDate": transaction_date,
  "invoiceTime": transaction_time,
  "products": ipart_arr,
  "bottomNotice": ""
};
}
var data = getSampleData();
easyinvoice.createInvoice(data, function(result) {
  var date_format = new Date();
  var bill_name = "SHW"+ date_format.getDate() + date_format.getMonth() + date_format.getFullYear() + date_format.getHours() + date_format.getMinutes() + date_format.getSeconds()
  easyinvoice.download(`${bill_name}.pdf`, result.pdf);
  //	you can download like this as well:
  //	easyinvoice.download();
  //	easyinvoice.download('myInvoice.pdf');
});
}

</script>
  

  <script src="js/plugins/perfect-scrollbar.min.js"></script>
  <script src="js/plugins/smooth-scrollbar.min.js"></script>

  <script>
    var win = navigator.platform.indexOf('Win') > -1
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5',
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options)
    }
  </script>
  <!-- Github buttons -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <script src="js/argon-dashboard.js?v=2.0.4"></script>

  <%- include('partials/footer') %>
</body>
